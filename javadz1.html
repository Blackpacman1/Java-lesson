<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ДЗ3</title>
</head>
<body>
    <script>
        function getNumber(min, max){
            let number = parseInt(Math.random()*(max - min) + min);
            if (number === -0) number = 0;
            return number;
        }

        // 1. Написать функцию, преобразующую число в объект. Передавая на вход число от 0 до 999, мы должны получить на выходе объект, в котором в соответствующих свойствах описаны единицы, десятки и сотни. Например для числа 245 мы должны получить следующий объект: {‘единицы’: 5, ‘десятки’: 4, 'сотни’: 2}. Если число превышает 999, необходимо выдать соответствующее сообщение с помощью console.log и вернуть пустой объект.
function num2Obj(num){
	if (isNaN(num)){
	  console.log('Ошибка: параметр не является числом');
	} else if(num>999 || num<0){
		console.log('Ошибка: допустимый диапазон 0-999');
	  var obj={};
	  return obj;
	} else {
		var digits=['единицы','десятки','сотни'];
	  var obj={};
	  var i=0;
	  for(var i=0; num!=0; i++){
	  	obj[digits[i]]=num%10;
	  	num=(num-num%10)/10;
		}
		}	
		return obj;
	}
console.log(num2Obj(245));
console.log(num2Obj(45));
console.log(num2Obj(5));

        // 2 Продолжить работу с интернет-магазином:
        // 2.1(2.2) В прошлом домашнем задании вы реализовали корзину на базе массивов. Какими объектами можно заменить их элементы?
        // Ответ: Можно использовать решение типа:
String[] row = new String[2];
row[0] = "pencil";
row[1] = "50";
        //Заменить на это:
        Performance row = new Performance();
row.setName("pencil");
row.setWins("50");


        // 2.3 Перенести функционал подсчета корзины на объектно-ориентированную базу.
        // Ответ: 
'use srtict';
let productButtons = document.querySelectorAll('.buyBtn');
productButtons.forEach(function (btn) {
    btn.addEventListener('click', function (event) {
        let id = event.srcElement.dataset.id;
        let price = event.srcElement.dataset.price;
        let name = event.srcElement.dataset.name;
        let img = event.srcElement.dataset.img;
        cart.addProduct({ 
            id: id, 
            img: img,
            price: price, 
            name: name 
        })
    })
});
 
let cart = {
    products: {},
    /**
     * Добавляет продукт в корзину
    */
    addProduct(product) {
        this.productObject(product);
        this.renderProduct(product);
        this.productsTotalRender();
        this.productAddDeleteListeners();
        cart.productsQtyInCart();
    },
    /**
     * Обрабатывает событие кнопки удаления товара
     */
    productDeleteListener(event) {
        
        cart.productDelete(event);
        cart.productsTotalRender();
        cart.productsQtyInCart();
       
    },
    /**
     * Добавляет слушателей события на кнопки удаления
     */
    productAddDeleteListeners() {
        let delBtns = document.querySelectorAll('.productDelete');
        for (let i = 0; i < delBtns.length; i++) {
            delBtns[i].addEventListener('click', this.productDeleteListener);
        }
    },
    /**
    * Пишет сумму и количество товаров
    */
    productsTotalRender() {
        document.querySelector('.shop-price').textContent = this.productsTotal();
        
    },
    /**
     * Рендерит количество продуктов
     */
      productsQtyInCart() {
        let sumQtyInCart = document.querySelectorAll('.menu-shop>li').length-1;
        document.querySelector('.clor-cart').textContent = sumQtyInCart;
    },
     
    /**
     * Сам продукт в объекте
     */
    productObject(product) {
        if (this.products[product.id] == undefined) {
            this.products[product.id] = {
                img:product.img,
                price: product.price,
                name: product.name,
                count: 1
            }
        }
        
        else {
            this.products[product.id].count++;
        }
    },
    /**
      * Отрисовывает продукт в корзине
      */
    renderProduct(product) {
        let productCartExists = document.querySelector(`.productCount[data-id="${product.id}"]`);
        if (productCartExists !== null) {
            productCartExists.textContent++;
            return;
        }
        let productUnit = `
                            <li class="shop-item">
                                        <div class="shop-cart">
                                            <div class="image-shop">
                                                <img src="${product.img}" alt="">
                                            </div>
                                            <div class="next-shop">
                                                <i class="fa fa-times-circle productDelete" data-id="${product.id}"></i>
                                            </div>
                                            <div class="list-names">
                                                <a href="${product.id}">${product.name}</a>
 
                                            </div>
                                            <span class="price">
                                                <span class="amount">${product.price} руб/м2</span>
                                            </span>
                                            <div class="list-qty">
                                                <p>ШТУК: <span class="productCount" data-id="${product.id}">1</span></p>
                                            </div>
                                        </div></li>
 
                            `;
        let tbody = document.querySelector('.menu-shop');
        tbody.insertAdjacentHTML("afterbegin", productUnit);
    },
    /**
     * Считает общую сумму
     */
    productsTotal() {
        let sumTotal = 0;
        for (let ids in this.products) {
            sumTotal += this.products[ids].price * this.products[ids].count;
        }
        return sumTotal;
    },

    </script>
(c) Пронин Алексей 2021
</body>
</html>